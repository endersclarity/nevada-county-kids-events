# E4.5: Delivery Method Router

**Epic:** E4 - Delivery Layer
**Story ID:** E4.5
**Story Points:** 3
**Priority:** P1 (High)
**Type:** Feature
**Status:** ⏸️ Blocked

---

## User Story

**As a** developer
**I want to** route delivery requests to appropriate handler
**So that** orchestrator can support multiple methods

---

## Acceptance Criteria

- [ ] Implement `src/delivery/router.py` with `DeliveryRouter` class
- [ ] Registry of available delivery methods (name -> class mapping)
- [ ] Method: `deliver(events, method_name, **options)`
  - Validate method exists (return error if unknown)
  - Instantiate delivery class
  - Validate configuration (call `validate_config()`)
  - Execute delivery
  - Return result
- [ ] Support multiple simultaneous deliveries (e.g., email + telegram)
- [ ] Log delivery attempts and results
- [ ] Unit test with mocked delivery classes

---

## Registry Example

```python
DELIVERY_METHODS = {
    'email': EmailDelivery,
    'telegram': TelegramDelivery,
    'gcal': GoogleCalendarDelivery,
}
```

---

## Dependencies

**Depends on:** E4.2 (Email), E4.3 (Telegram)
**Blocks:** E5.2 (Command Orchestration)

**Optional:** E4.4 (Google Calendar) - can be added later

---

## Definition of Done

- [ ] Router instantiates correct delivery class
- [ ] Unknown methods return error
- [ ] Configuration validated before delivery
- [ ] Can deliver via multiple methods simultaneously
- [ ] Unit tests pass
- [ ] Logging shows delivery attempts

---

## Technical Notes

Router should handle:
- Method validation
- Config validation (fail early if missing credentials)
- Error handling (graceful failure if one method fails)
- Logging for debugging

---

**Created:** 2025-10-07
**Last Updated:** 2025-10-07
