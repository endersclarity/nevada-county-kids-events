# E4.4: Google Calendar Integration

**Epic:** E4 - Delivery Layer
**Story ID:** E4.4
**Story Points:** 8
**Priority:** P2 (Low)
**Type:** Feature
**Status:** â¸ï¸ Blocked

---

## User Story

**As a** user
**I want to** add events to Google Calendar
**So that** they appear in my calendar app

---

## Acceptance Criteria

- [ ] Implement `src/delivery/gcal.py` with `GoogleCalendarDelivery` class
- [ ] Install `google-api-python-client` and `google-auth` libraries
- [ ] Set up OAuth2 credentials (Google Cloud Console)
- [ ] Authenticate user (one-time OAuth flow, store refresh token)
- [ ] For each event:
  - Create calendar event with title, date, description, location
  - Set event source URL as metadata
  - Avoid duplicates (check if event already exists by source_event_id)
- [ ] Batch create events (API efficiency)
- [ ] Handle API errors (quota exceeded, auth failure)
- [ ] Return `DeliveryResult` with success status
- [ ] Test with real Google Calendar

---

## OAuth Setup

1. Create project in Google Cloud Console
2. Enable Google Calendar API
3. Create OAuth 2.0 credentials (Desktop app)
4. Store `credentials.json` (not in git)
5. Generate `token.json` on first run (stored locally)

---

## Environment Variables

```
GCAL_CREDENTIALS_FILE=credentials.json
GCAL_TOKEN_FILE=token.json
GCAL_CALENDAR_ID=primary
```

---

## Dependencies

**Depends on:** E4.1 (Delivery Interface)
**Blocks:** E4.5 (Delivery Router) [Optional - can skip for MVP]

---

## Definition of Done

- [ ] OAuth flow works
- [ ] Events created in Google Calendar
- [ ] Duplicates prevented
- [ ] Test calendar shows events
- [ ] validate_config() checks credentials

---

## Technical Notes

**Complexity:** This is the most complex delivery method (8 points) due to OAuth setup. Consider **optional for MVP** - focus on Email + Telegram first (E4.2, E4.3).

Add to requirements.txt:
```
google-api-python-client>=2.100.0
google-auth>=2.23.0
```

---

**Created:** 2025-10-07
**Last Updated:** 2025-10-07
